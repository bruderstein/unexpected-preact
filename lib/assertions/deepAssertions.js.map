{"version":3,"sources":["../../src/assertions/deepAssertions.js"],"names":["eventConstructorMap","animationend","window","AnimationEvent","animationiteration","animationstart","beforeunload","BeforeUnloadEvent","beginEvent","TimeEvent","blur","FocusEvent","click","MouseEvent","compositionend","CompositionEvent","compositionstart","compositionupdate","contextmenu","dblclick","DOMActivate","UIEvent","DOMAttributeNameChanged","MutationNameEvent","DOMAttrModified","MutationEvent","DOMCharacterDataModified","DOMElementNameChanged","DOMNodeInserted","DOMNodeInsertedIntoDocument","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMSubtreeModified","drag","DragEvent","dragend","dragenter","dragleave","dragover","dragstart","drop","end","SpeechSynthesisEvent","error","focus","gamepadconnected","GamepadEvent","gamepaddisconnected","gotpointercapture","PointerEvent","hashchange","HashChangeEvent","lostpointercapture","keydown","KeyboardEvent","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","paste","ClipboardEvent","pointercancel","pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup","repeatEvent","resize","scroll","select","show","SVGAbort","SVGEvent","SVGError","SVGLoad","SVGResize","SVGScroll","SVGUnload","SVGZoom","SVGZoomEvent","touchcancel","TouchEvent","touchend","touchmove","touchstart","transitionend","TransitionEvent","unload","wheel","WheelEvent","triggerEvent","expect","component","target","eventName","eventArgs","targetDOM","hasOwnProperty","setState","base","node","EventConstructor","Event","event","Object","assign","bubbles","cancellable","view","dispatchEvent","renderIntoDocument","element","container","document","createElement","installInto","assertionGenerator","ActualAdapter","QueryAdapter","ExpectedAdapter","actualTypeName","queryTypeName","expectedTypeName","getRenderOutput","type","COMPONENT_TYPE","NODE_TYPE","wrapRootNode","actualRenderOutputType","getDiffInputFromRenderOutput","renderOutput","rewrapResult","renderer","wrapResultForReturn","result","_component","bind","canTriggerEventsOnOutputType","StatelessWrapper","props","children","addAssertion","subject","shift","expected","flags","exactly"],"mappings":"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","file":"deepAssertions.js","sourcesContent":["import UnexpectedHtmlLike from 'unexpected-htmllike';\nimport PreactRenderedAdapter from 'unexpected-htmllike-preactrendered-adapter';\nimport PreactElementAdapter from 'unexpected-htmllike-preact-adapter';\nimport AssertionGenerator from './AssertionGenerator';\nimport { h, Component, render } from 'preact';\n\n\n// These are events that have a more specific constructor\nconst eventConstructorMap = {\n  animationend: window.AnimationEvent,\n  animationiteration: window.AnimationEvent,\n  animationstart: window.AnimationEvent,\n  beforeunload: window.BeforeUnloadEvent,\n  beginEvent: window.TimeEvent,\n  blur: window.FocusEvent,\n  click: window.MouseEvent,\n  compositionend: window.CompositionEvent,\n  compositionstart: window.CompositionEvent,\n  compositionupdate: window.CompositionEvent,\n  contextmenu: window.MouseEvent,\n  dblclick: window.MouseEvent,\n  DOMActivate: window.UIEvent,\n  DOMAttributeNameChanged: window.MutationNameEvent,\n  DOMAttrModified: window.MutationEvent,\n  DOMCharacterDataModified: window.MutationEvent,\n  DOMElementNameChanged: window.MutationNameEvent,\n  DOMNodeInserted: window.MutationEvent,\n  DOMNodeInsertedIntoDocument: window.MutationEvent,\n  DOMNodeRemoved: window.MutationEvent,\n  DOMNodeRemovedFromDocument: window.MutationEvent,\n  DOMSubtreeModified: window.MutationEvent,\n  drag: window.DragEvent,\n  dragend: window.DragEvent,\n  dragenter: window.DragEvent,\n  dragleave: window.DragEvent,\n  dragover: window.DragEvent,\n  dragstart: window.DragEvent,\n  drop: window.DragEvent,\n  end: window.SpeechSynthesisEvent,\n  error: window.UIEvent,\n  focus: window.FocusEvent,\n  gamepadconnected: window.GamepadEvent,\n  gamepaddisconnected: window.GamepadEvent,\n  gotpointercapture: window.PointerEvent,\n  hashchange: window.HashChangeEvent,\n  lostpointercapture: window.PointerEvent,\n  keydown: window.KeyboardEvent,\n  keypress: window.KeyboardEvent,\n  keyup: window.KeyboardEvent,\n  load: window.UIEvent,\n  mousedown: window.MouseEvent,\n  mouseenter: window.MouseEvent,\n  mouseleave: window.MouseEvent,\n  mousemove: window.MouseEvent,\n  mouseout: window.MouseEvent,\n  mouseover: window.MouseEvent,\n  mouseup: window.MouseEvent,\n  paste: window.ClipboardEvent,\n  pointercancel: window.PointerEvent,\n  pointerdown: window.PointerEvent,\n  pointerenter: window.PointerEvent,\n  pointerleave: window.PointerEvent,\n  pointermove: window.PointerEvent,\n  pointerout: window.PointerEvent,\n  pointerover: window.PointerEvent,\n  pointerup: window.PointerEvent,\n  repeatEvent: window.TimeEvent,\n  resize: window.UIEvent,\n  scroll: window.UIEvent,\n  select: window.UIEvent,\n  show: window.MouseEvent,\n  SVGAbort: window.SVGEvent,\n  SVGError: window.SVGEvent,\n  SVGLoad: window.SVGEvent,\n  SVGResize: window.SVGEvent,\n  SVGScroll: window.SVGEvent,\n  SVGUnload: window.SVGEvent,\n  SVGZoom: window.SVGZoomEvent,\n  touchcancel: window.TouchEvent,\n  touchend: window.TouchEvent,\n  touchmove: window.TouchEvent,\n  touchstart: window.TouchEvent,\n  transitionend: window.TransitionEvent,\n  unload: window.UIEvent,\n  wheel: window.WheelEvent\n};\n\nfunction triggerEvent(expect, component, target, eventName, eventArgs) {\n  let targetDOM = component;\n\n  if (targetDOM.hasOwnProperty('props') && targetDOM.hasOwnProperty('context') && typeof targetDOM.setState === 'function') {\n    // This is an instance of a component from preact-compat\n    targetDOM = targetDOM.base;\n  }\n  if (target) {\n    targetDOM = target.node;\n  }\n\n  const EventConstructor = eventConstructorMap[eventName] || window.Event;\n  let event = new EventConstructor(\n    eventName,\n    Object.assign({ bubbles: true, cancellable: true, view: window }, eventArgs)\n  );\n  targetDOM.dispatchEvent(event);\n}\n\nfunction renderIntoDocument(element) {\n  const container = window.document.createElement('div');\n  return render(element, container);\n}\n\nfunction installInto(expect) {\n  \n  const assertionGenerator = new AssertionGenerator({\n    ActualAdapter: PreactRenderedAdapter,\n    QueryAdapter: PreactElementAdapter,\n    ExpectedAdapter: PreactElementAdapter,\n    actualTypeName: 'RenderedPreactElement',\n    queryTypeName: 'PreactElement',\n    expectedTypeName: 'PreactElement',\n    getRenderOutput: component => {\n      if (component &&\n          typeof component === 'object' &&\n          (component.type === PreactRenderedAdapter.COMPONENT_TYPE ||\n          component.type === PreactRenderedAdapter.NODE_TYPE)) {\n        return component;\n      }\n      return PreactRenderedAdapter.wrapRootNode(component);\n    },\n    actualRenderOutputType: 'RenderedPreactElementWrapper',\n    getDiffInputFromRenderOutput: renderOutput => renderOutput,\n    rewrapResult: (renderer, target) => target,\n    wrapResultForReturn: (component, target) => {\n      const result = (target || component);\n      if (!result) {\n        return result;\n      }\n      if (result.type === PreactRenderedAdapter.COMPONENT_TYPE) {\n        return result.component;\n      }\n      if (result.type === PreactRenderedAdapter.NODE_TYPE) {\n        return result.node;\n      }\n      if (result._component) {\n        return result._component;\n      }\n      return result;\n    },\n    triggerEvent: triggerEvent.bind(null, expect),\n    canTriggerEventsOnOutputType: true\n  });\n\n  assertionGenerator.installInto(expect);\n  \n  class StatelessWrapper extends Component {\n      render() {\n          return this.props.children;\n      }\n  }\n\n  expect.addAssertion('<PreactElement> when [deeply] rendered <assertion?>', function (expect, subject) {\n      let component;\n      component = renderIntoDocument(subject);\n      return expect.shift(component);\n  });\n\n  expect.addAssertion('<PreactElement> to [exactly] [deeply] render [with all children] [with all wrappers] [with all classes] [with all attributes] as <PreactElement>', function (expect, subject, expected) {\n\n      if (this.flags.exactly) {\n          return expect(subject, 'when deeply rendered', 'to have exactly rendered', expected);\n      }\n      return expect(subject, 'when deeply rendered to have rendered [with all children] [with all wrappers] [with all classes] [with all attributes]', expected);\n  });\n}\n\nexport { installInto, triggerEvent };\n"]}